<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" class="no-js" lang="es">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>ReciCar - Búsqueda rápida de categoría</title>
    <meta name="description" content="Busca repuestos por categoría en ReciCar">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.ico">

     <!-- CSS 
    ========================= -->
     <!--bootstrap min css-->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!--owl carousel min css-->
    <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
    <!--slick min css-->
    <link rel="stylesheet" href="assets/css/slick.css">
    <!--magnific popup min css-->
    <link rel="stylesheet" href="assets/css/magnific-popup.css">
    <!--font awesome css-->
    <link rel="stylesheet" href="assets/css/font.awesome.css">
    <!--ionicons min css-->
    <link rel="stylesheet" href="assets/css/ionicons.min.css">
    <!--animate css-->
    <link rel="stylesheet" href="assets/css/animate.css">
    <!--jquery ui min css-->
    <link rel="stylesheet" href="assets/css/jquery-ui.min.css">
    <!--slinky menu css-->
    <link rel="stylesheet" href="assets/css/slinky.menu.css">
    <!-- Plugins CSS -->
    <link rel="stylesheet" href="assets/css/plugins.css">
    
    <!-- Main Style CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
    
    <!--modernizr min js here-->
    <script src="assets/js/vendor/modernizr-3.7.1.min.js"></script>

    <style>
        .categories-page {
            background-color: #f8f9fa;
            min-height: 100vh;
        }
        
        .categories-header {
            background-color: #ffffff;
            padding: 40px 0 20px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .categories-title {
            font-size: 28px;
            font-weight: 600;
            color: #333333;
            margin: 0;
            text-align: left;
        }
        
        .categories-list {
            background-color: #f8f9fa;
            padding: 20px 0 40px 0;
        }
        
        .category-item {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            margin-bottom: 8px;
            background-color: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            text-decoration: none;
            color: #333333;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .category-item:hover {
            background-color: #f8f9fa;
            text-decoration: none;
            color: #333333;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .category-item.active {
            background-color: #fff3cd;
            border-color: #ffc107;
        }
        
        .category-item.active .category-name,
        .category-item.active .category-count,
        .category-item.active .category-expand {
            color: #ff8c00;
        }
        
        .category-icon {
            width: 24px;
            height: 24px;
            margin-right: 16px;
            color: #666666;
            flex-shrink: 0;
            font-size: 18px;
        }
        
        .category-name {
            flex: 1;
            font-size: 16px;
            font-weight: 500;
            color: #333333;
            margin: 0;
        }
        
        .category-count {
            font-size: 14px;
            color: #6c757d;
            margin-right: 12px;
            font-weight: 400;
        }
        
        .category-expand {
            width: 20px;
            height: 20px;
            color: #6c757d;
            flex-shrink: 0;
            font-size: 16px;
            font-weight: bold;
            transition: transform 0.2s ease;
        }
        
        .category-item.expanded .category-expand {
            transform: rotate(45deg);
        }
        
        .subcategories {
            display: none;
            background-color: #f8f9fa;
            border-left: 3px solid #ffc107;
            margin-left: 20px;
            margin-top: 8px;
            border-radius: 0 8px 8px 0;
        }
        
        .subcategories.show {
            display: block;
        }
        
        .subcategory-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            margin-bottom: 4px;
            background-color: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            text-decoration: none;
            color: #495057;
            transition: all 0.2s ease;
        }
        
        .subcategory-item:hover {
            background-color: #e9ecef;
            text-decoration: none;
            color: #495057;
        }
        
        .subcategory-name {
            flex: 1;
            font-size: 14px;
            font-weight: 400;
            margin: 0;
        }
        
        .subcategory-count {
            font-size: 12px;
            color: #6c757d;
            margin-right: 8px;
        }
        
        .container-custom {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .search-box {
            background-color: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 16px;
            color: #333333;
        }
        
        .search-box input::placeholder {
            color: #6c757d;
        }
        
        .search-icon {
            color: #6c757d;
            margin-right: 12px;
        }
    </style>
</head>

<body>
    <!-- Main Wrapper Start -->
    <!--header area start-->
    <th:block th:replace="fragments/_header :: header"></th:block>
    <!--header area end-->

    <!--Offcanvas menu area start-->
    <th:block th:replace="fragments/_offcanvasmenu :: offcanvasmenu"></th:block>
    <!--Offcanvas menu area end-->

    <!-- Categories Page Start -->
    <div class="categories-page">
        <div class="container-custom">
            <!-- Categories Header -->
            <div class="categories-header">
                <h1 class="categories-title">Búsqueda rápida de categoría</h1>
            </div>
            
            <!-- Search Box -->
            <div class="search-box">
                <i class="fa fa-search search-icon"></i>
                <input type="text" placeholder="Búsqueda rápida de categoría" id="categorySearch">
            </div>
            
            <!-- Categories List -->
            <div class="categories-list">
                <!-- Dynamic Categories from Backend -->
                <th:block th:each="category : ${categories}">
                    <th:block th:if="${category.parent == null}">
                        <a th:href="@{/search/category(slug=${category.slug})}" class="category-item" th:attr="data-category=${category.slug}">
                            <div class="category-icon">
                                <i class="fa fa-cog"></i>
                            </div>
                            <h3 class="category-name" th:text="${category.name}">Category Name</h3>
                            <span class="category-count" th:text="${category.products.size()}">0</span>
                            <div class="category-expand" th:if="${!category.children.isEmpty()}">+</div>
                        </a>
                        <div class="subcategories" th:if="${!category.children.isEmpty()}" th:id="'subcategories-' + ${category.slug}">
                            <a th:each="subcategory : ${category.children}" 
                               th:href="@{/search/category(slug=${subcategory.slug})}" 
                               class="subcategory-item">
                                <span class="subcategory-name" th:text="${subcategory.name}">Subcategory Name</span>
                                <span class="subcategory-count" th:text="${subcategory.products.size()}">0</span>
                            </a>
                        </div>
                    </th:block>
                </th:block>

                <!-- Fallback if no categories (keep one example for styling) -->
                <th:block th:if="${categories == null or categories.isEmpty()}">
                    <div class="category-item" data-category="caja-cambios-embrague-transmision">
                        <div class="category-icon">
                            <i class="fa fa-cogs"></i>
                        </div>
                        <h3 class="category-name">Caja de cambios/embrague/transmisión</h3>
                        <span class="category-count">6276</span>
                        <div class="category-expand">+</div>
                    </div>
                    <div class="subcategories" id="subcategories-caja-cambios-embrague-transmision">
                        <a href="#" class="subcategory-item">
                            <span class="subcategory-name">Caja de cambios manual de 5 velocidades</span>
                            <span class="subcategory-count">142</span>
                        </a>
                        <a href="#" class="subcategory-item">
                            <span class="subcategory-name">Caja de cambios manual de 6 velocidades</span>
                            <span class="subcategory-count">9</span>
                        </a>
                        <a href="#" class="subcategory-item">
                            <span class="subcategory-name">Caja de cambios automática</span>
                            <span class="subcategory-count">265</span>
                        </a>
                    </div>
                </th:block>
            </div>
        </div>
    </div>
    <!-- Categories Page End -->

    <!--call to action start-->
    <th:block th:replace="fragments/_calltoaction :: calltoaction"></th:block>
    <!--call to action end-->

    <!--footer area start-->
    <th:block th:replace="fragments/_footer :: footer"></th:block>
    <!--footer area end-->

    <!-- JS
    ============================================ -->
    <!--jquery min js-->
    <script src="assets/js/vendor/jquery-3.4.1.min.js"></script>
    <!--popper min js-->
    <script src="assets/js/popper.js"></script>
    <!--bootstrap min js-->
    <script src="assets/js/bootstrap.min.js"></script>
    <!--owl carousel min js-->
    <script src="assets/js/owl.carousel.min.js"></script>
    <!--slick min js-->
    <script src="assets/js/slick.min.js"></script>
    <!--magnific popup min js-->
    <script src="assets/js/jquery.magnific-popup.min.js"></script>
    <!--jquery countdown min js-->
    <script src="assets/js/jquery.countdown.js"></script>
    <!--jquery ui min js-->
    <script src="assets/js/jquery.ui.js"></script>
    <!--jquery elevatezoom min js-->
    <script src="assets/js/jquery.elevatezoom.js"></script>
    <!--isotope packaged min js-->
    <script src="assets/js/isotope.pkgd.min.js"></script>
    <!--slinky menu js-->
    <script src="assets/js/slinky.menu.js"></script>
    <!-- Plugins JS -->
    <script src="assets/js/plugins.js"></script>

    <!-- Main JS -->
    <script src="assets/js/main.js"></script>

    <!-- Categories Page JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get all category items and search input
            const categoryItems = document.querySelectorAll('.category-item');
            const searchInput = document.getElementById('categorySearch');
            
            // Handle category expansion/collapse
            categoryItems.forEach(item => {
                const expandButton = item.querySelector('.category-expand');
                const categoryName = item.getAttribute('data-category');
                const subcategories = document.getElementById(`subcategories-${categoryName}`);
                
                // Click handler for category item
                item.addEventListener('click', function(e) {
                    // Don't trigger if clicking on subcategory links
                    if (e.target.closest('.subcategory-item')) {
                        return;
                    }
                    
                    // Toggle active state
                    categoryItems.forEach(cat => cat.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Toggle expanded state
                    const isExpanded = item.classList.contains('expanded');
                    
                    // Close all other categories
                    categoryItems.forEach(cat => {
                        cat.classList.remove('expanded');
                        const catName = cat.getAttribute('data-category');
                        const catSubcategories = document.getElementById(`subcategories-${catName}`);
                        if (catSubcategories) {
                            catSubcategories.classList.remove('show');
                        }
                    });
                    
                    // Toggle current category
                    if (!isExpanded) {
                        item.classList.add('expanded');
                        if (subcategories) {
                            subcategories.classList.add('show');
                        }
                    }
                });
            });
            
            // Search functionality
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                categoryItems.forEach(item => {
                    const categoryName = item.querySelector('.category-name').textContent.toLowerCase();
                    const subcategories = item.nextElementSibling;
                    
                    if (categoryName.includes(searchTerm)) {
                        item.style.display = 'flex';
                        if (subcategories) {
                            subcategories.style.display = 'block';
                        }
                    } else {
                        item.style.display = 'none';
                        if (subcategories) {
                            subcategories.style.display = 'none';
                        }
                    }
                });
            });
            
            // Clear search on escape key
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    this.value = '';
                    categoryItems.forEach(item => {
                        item.style.display = 'flex';
                        const categoryName = item.getAttribute('data-category');
                        const subcategories = document.getElementById(`subcategories-${categoryName}`);
                        if (subcategories) {
                            subcategories.style.display = 'none';
                        }
                    });
                }
            });
        });
    </script>

</body>

</html>
